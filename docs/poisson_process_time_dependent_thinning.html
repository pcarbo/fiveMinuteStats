<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />



<meta name="date" content="2026-02-05" />

<title>Time-dependent thinning of a Poisson process</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">fiveMinuteStats</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/pcarbo/fiveMinuteStats">source</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Time-dependent thinning of a Poisson
process</h1>
<h4 class="author">John Novembre</h4>
<address class="author_afil">
University of Chicago<br><h4 class="date">February 5, 2026</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2026-02-05
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>fiveMinuteStats/analysis/</code>
<span class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.1). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted
changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges"
class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown file has unstaged changes. To know which version of
the R Markdown file created these results, you’ll want to first commit
it to the Git repo. If you’re still working on the analysis, you can
ignore this warning. When you’re finished, you can run
<code>wflow_publish</code> to commit the R Markdown file and build the
HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed12345code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(12345)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed12345code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(12345)</code> was run prior to running the
code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcompcarbofiveMinuteStatstree4e88e63e9fe963f320cb4750de03bbbac34476a7targetblank4e88e63a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/pcarbo/fiveMinuteStats/tree/4e88e63e9fe963f320cb4750de03bbbac34476a7" target="_blank">4e88e63</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcompcarbofiveMinuteStatstree4e88e63e9fe963f320cb4750de03bbbac34476a7targetblank4e88e63a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/pcarbo/fiveMinuteStats/tree/4e88e63e9fe963f320cb4750de03bbbac34476a7" target="_blank">4e88e63</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    analysis/bernoulli_poisson_process_cache/

Unstaged changes:
    Modified:   analysis/poisson_process_time_dependent_thinning.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown
(<code>analysis/poisson_process_time_dependent_thinning.Rmd</code>) and
HTML (<code>docs/poisson_process_time_dependent_thinning.html</code>)
files. If you’ve configured a remote Git repository (see
<code>?wflow_git_remote</code>), click on the hyperlinks in the table
below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/4e88e63e9fe963f320cb4750de03bbbac34476a7/analysis/poisson_process_time_dependent_thinning.Rmd" target="_blank">4e88e63</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2026-02-05
</td>
<td>
Generated pdf version of poisson_process_time_dependent_thinning
vignette.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/fiveMinuteStats/4e88e63e9fe963f320cb4750de03bbbac34476a7/docs/poisson_process_time_dependent_thinning.html" target="_blank">4e88e63</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2026-02-05
</td>
<td>
Generated pdf version of poisson_process_time_dependent_thinning
vignette.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/fiveMinuteStats/5f62ee6cf86b77e9f45e0c6b6e3d6b97c7faf675/docs/poisson_process_time_dependent_thinning.html" target="_blank">5f62ee6</a>
</td>
<td>
Matthew Stephens
</td>
<td>
2019-03-31
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/0cd28bd3e7aea2258f9c3a55e2e0060c55403123/analysis/poisson_process_time_dependent_thinning.Rmd" target="_blank">0cd28bd</a>
</td>
<td>
Matthew Stephens
</td>
<td>
2019-03-31
</td>
<td>
workflowr::wflow_publish(all = TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/fiveMinuteStats/34bcc51fef570dd7d5a70859f262c983fed17381/docs/poisson_process_time_dependent_thinning.html" target="_blank">34bcc51</a>
</td>
<td>
John Blischak
</td>
<td>
2017-03-06
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/5fbc8b5c658203baf6765874b24794d41da622a8/analysis/poisson_process_time_dependent_thinning.Rmd" target="_blank">5fbc8b5</a>
</td>
<td>
John Blischak
</td>
<td>
2017-03-06
</td>
<td>
Update workflowr project with wflow_update (version 0.4.0).
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/391ba3c0cf210ea8de8125ee8063557ceff55080/analysis/poisson_process_time_dependent_thinning.Rmd" target="_blank">391ba3c</a>
</td>
<td>
John Blischak
</td>
<td>
2017-03-06
</td>
<td>
Remove front and end matter of non-standard templates.
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/fiveMinuteStats/8e616835a4eccac7c4e0a8eeec86fdcefb1525ab/docs/poisson_process_time_dependent_thinning.html" target="_blank">8e61683</a>
</td>
<td>
Marcus Davy
</td>
<td>
2017-03-03
</td>
<td>
rendered html using wflow_build(all=TRUE)
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/pcarbo/fiveMinuteStats/c3b365a48f7fc76cf83ade425916d31e547d8077/docs/poisson_process_time_dependent_thinning.html" target="_blank">c3b365a</a>
</td>
<td>
John Blischak
</td>
<td>
2017-01-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/67a857539cd8a4029e899208aed19da6c78b4b36/analysis/poisson_process_time_dependent_thinning.Rmd" target="_blank">67a8575</a>
</td>
<td>
John Blischak
</td>
<td>
2017-01-02
</td>
<td>
Use external chunk to set knitr chunk options.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/5ec12c73e37fc3c7ec04a31f6d85eede0f6c436e/analysis/poisson_process_time_dependent_thinning.Rmd" target="_blank">5ec12c7</a>
</td>
<td>
John Blischak
</td>
<td>
2017-01-02
</td>
<td>
Use session-info chunk.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/2599ceb4502bf35e51c1dd8b6aa6e159d2b45f1c/analysis/poisson_process_time_dependent_thinning.Rmd" target="_blank">2599ceb</a>
</td>
<td>
jnovembre
</td>
<td>
2016-02-04
</td>
<td>
Polishing pp example
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/8f8333735f095c9e0e566415184d559a2b19a96d/analysis/poisson_process_time_dependent_thinning.Rmd" target="_blank">8f83337</a>
</td>
<td>
jnovembre
</td>
<td>
2016-02-04
</td>
<td>
Addiing poisson_process with time dept thinning example, and move lin eq
sectio in markov_chains_discrete_stationary
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<p>See <a
href="https://github.com/pcarbo/fiveMinuteStats/blob/master/docs/poisson_process_time_dependent_thinning.pdf">here</a>
for a PDF version of this vignette.</p>
<div id="prerequisites" class="section level1">
<h1>Prerequisites</h1>
<p>This vignette assumes a previous introduction to Poisson
Processes.</p>
</div>
<div id="overview" class="section level1">
<h1>Overview</h1>
<p>An important extension to the basic Poisson Process with rate <span
class="math inline">\(\lambda\)</span> is to consider that each arrival
may be categorized according to a certain type. If we let <span
class="math inline">\(K\)</span> be the total number of types, we might
build a model in which the types are determined probabilistically
according to a set of type probabilities (<span
class="math inline">\(p_1,\ldots,p_K\)</span>,<span
class="math inline">\(\sum_{i=1}^K p_i = 1\)</span>). In this case,
where we say the type probabilities are <em>time-homogeneous</em>, the
arrivals of type <span class="math inline">\(i\)</span> form a thinned
Poisson Process that has a rate parameter of <span
class="math inline">\(\lambda p_i\)</span>.</p>
<p>In this vignette, we are going to address the more difficult case in
which the type probabilities vary through time.</p>
<p>Let <span class="math inline">\(P_i(s)\)</span> reflect the
probability of an arrival being type <span
class="math inline">\(i\)</span> given it arrives at time <span
class="math inline">\(s\)</span>. A result from Poisson Process theory
is that the number of arrivals of type <span
class="math inline">\(i\)</span> by time <span
class="math inline">\(t\)</span>, which we denote <span
class="math inline">\(N_i(t)\)</span>, will be Poisson with rate <span
class="math display">\[
N_i(t) \sim Pois(\lambda \int_0^t P_i(s)ds).
\]</span> Our first goal here is to demonstrate this result holds true
in some simulations.</p>
</div>
<div
id="simulating-a-poisson-process-with-time-dependent-type-probabilities"
class="section level1">
<h1>Simulating a Poisson Process with time-dependent type
probabilities</h1>
<p>An algorithm for simulating a Poisson Process with time-dependent
type probabilities can be fairly simple:</p>
<ol style="list-style-type: decimal">
<li><p>Simulate the number of arrivals <span
class="math inline">\(N\)</span> via a <span
class="math inline">\(Pois(\lambda t)\)</span></p></li>
<li><p>Conditional on <span class="math inline">\(N\)</span>, simluate
the arrival times as independent uniform draws from <span
class="math inline">\((0,t]\)</span>.</p></li>
<li><p>For each arrival, simulate it’s type from the discrete
probability distribution specified by <span
class="math inline">\({P_i(t),i=1,\ldots,K}\)</span>.</p></li>
</ol>
<p>Let’s try this in practice.</p>
<div id="motivation-the-rate-of-arrival-of-successful-foragers"
class="section level2">
<h2>Motivation: The rate of arrival of successful foragers</h2>
<p>So that we have a concrete example, suppose that we are monitoring
the success of foragers, who have a maximum capacity of gathering <span
class="math inline">\(K\)</span> food items. The number collected by
each forager determines their type (so a forager who brings back 3 items
is type 3). Let’s further suppose the number of food items they gather
is binomially distributed with a probability that is time dependent
according to a function <span class="math inline">\(p(t)\)</span>.
Further suppose we expect food to be harder and harder to gather - such
that <span class="math inline">\(p(t)\)</span> is a logistic decay
function <span class="math display">\[
p(t)=\frac{1}{1+e^{-b(t-a)}}
\]</span> where <span class="math inline">\(b&lt;0\)</span>. The
parameters <span class="math inline">\(a\)</span>determine the
inflection point of the logistic curve and <span
class="math inline">\(b\)</span> determines the rate of change of the
success probabilty through time.</p>
<p>To add some further interpretability to the parameters, let’s suppose
we are thinking of foraging bees returning to a hive and that our time
scale of interest is a single day of foraging (say 9 hours over which
they are returning to the hive), that the inflection point is midday (so
<span class="math inline">\(a=4.5\)</span> hours) and the rate at which
the flowers are being depleted has a logistic decay rate such that <span
class="math inline">\(b=-1\)</span>. Let’s plot this success probability
curve.</p>
<pre class="r"><code>t&lt;-seq(0,9,by=0.01)
p&lt;-function(t,a=4.5,b=-1){return(1/(1+exp(-b*(t-a))))}

# Plot for a=50, b=0.1
plot(t,p(t,a=4.5,b=-1),ylim=c(0,1))</code></pre>
<p><img src="figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-1-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-1-1">
Past versions of unnamed-chunk-1-1.png
</button>
</p>
<div id="fig-unnamed-chunk-1-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/4e88e63e9fe963f320cb4750de03bbbac34476a7/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-1-1.png" target="_blank">4e88e63</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2026-02-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/5f62ee6cf86b77e9f45e0c6b6e3d6b97c7faf675/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-1-1.png" target="_blank">5f62ee6</a>
</td>
<td>
Matthew Stephens
</td>
<td>
2019-03-31
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/c3b365a48f7fc76cf83ade425916d31e547d8077/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-1-1.png" target="_blank">c3b365a</a>
</td>
<td>
John Blischak
</td>
<td>
2017-01-02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Very cool. Let’s further suppose the rate at which foraging bees
return is 10 per hour and they can bring a maximum of 4 pollen granules
back. We might suppose using a binomial distribution to determine their
type is appropriate if they are visiting <span
class="math inline">\(K\)</span> flowers, and at each they have an
independent probability of picking up a pollen granule.</p>
<p>So if all goes well our Poisson Process result will help us derive
the number of bees of each type at different time-points during the day.
Going into this, we can expect that given <span
class="math inline">\(b&lt;0\)</span> the beginning of the process will
contain more type <span class="math inline">\(4\)</span> individuals,
and then later in the process it will decrease.</p>
</div>
<div id="simulation-of-a-single-instance" class="section level2">
<h2>Simulation of a single instance</h2>
<p>All the above is simply to say we have time-dependent thinned Poisson
Process with <span class="math inline">\(P_i(t) = P(X=k)\)</span>, where
<span class="math inline">\(X \sim Binom(n,p(t))\)</span>, <span
class="math inline">\(p(t)=\frac{1}{1+e^{-b(t-a)}}\)</span>, and <span
class="math inline">\(\lambda=10, K=4, t=9, a=4.5,
b=-1\)</span>. So we can now write out our full simulation code:</p>
<pre class="r"><code># Initialize parameters
lambda&lt;-10
K&lt;- 4
b&lt;- -1
a&lt;- 4.5
t&lt;- 9

# Declare p(t)
p&lt;-function(t,a=50,b=-0.1){return(1/(1+exp(-b*(t-a))))}

# Declare function that assigns a random type
assign_type&lt;-function(t,K,a,b){
 return(rbinom(1,K,p(t,a,b))) 
}

# Begin one replicate of simulation
## Draw total number of arrivals 
N&lt;-rpois(1,lambda*t)
## Draw the arrival times
arrival_times&lt;-runif(N,min=0,max=t)
## Assign types to the arrivals
types&lt;-numeric()
for(i in seq(1,N)){
  types[i]&lt;-assign_type(arrival_times[i],K,a,b)
}</code></pre>
<p>So the R variables N, arrival_times, and types contain the number of
arrivals, the sequence of arrival_times and types.</p>
</div>
<div id="ploting-results-for-a-realization-of-the-process"
class="section level2">
<h2>Ploting results for a realization of the process</h2>
<p>We can make a simple plot of the timing of arrivals, annotating them
each by type:</p>
<pre class="r"><code>## And let&#39;s make a plot
plot(c(0,t),c(0,0),type=&#39;l&#39;,xlab=&#39;Time (hours)&#39;,ylab=&#39;&#39;,yaxt=&#39;n&#39;);
points(arrival_times,rep(0,N),pch=&#39;|&#39;,cex=0.85)
text(arrival_times,rep(0.25,N),types,cex=0.85)</code></pre>
<p><img src="figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-3-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-3-1">
Past versions of unnamed-chunk-3-1.png
</button>
</p>
<div id="fig-unnamed-chunk-3-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/4e88e63e9fe963f320cb4750de03bbbac34476a7/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-3-1.png" target="_blank">4e88e63</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2026-02-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/5f62ee6cf86b77e9f45e0c6b6e3d6b97c7faf675/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-3-1.png" target="_blank">5f62ee6</a>
</td>
<td>
Matthew Stephens
</td>
<td>
2019-03-31
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/c3b365a48f7fc76cf83ade425916d31e547d8077/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-3-1.png" target="_blank">c3b365a</a>
</td>
<td>
John Blischak
</td>
<td>
2017-01-02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>And indeed we see the prevalence of types is changing and with the
higher number types becoming rarer as time progresses.</p>
<p>Another useful plot is the standard counting process plot:</p>
<pre class="r"><code>x&lt;-seq(0,t,by=0.01)
n_t&lt;-sapply(x,function(s) sum(arrival_times&lt;s))
plot(x,n_t,type=&#39;l&#39;,xlab=&#39;Time (hours)&#39;,ylab=&#39;# of returning bees&#39;)</code></pre>
<p><img src="figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-4-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-1">
Past versions of unnamed-chunk-4-1.png
</button>
</p>
<div id="fig-unnamed-chunk-4-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/4e88e63e9fe963f320cb4750de03bbbac34476a7/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-4-1.png" target="_blank">4e88e63</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2026-02-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/5f62ee6cf86b77e9f45e0c6b6e3d6b97c7faf675/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-4-1.png" target="_blank">5f62ee6</a>
</td>
<td>
Matthew Stephens
</td>
<td>
2019-03-31
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/c3b365a48f7fc76cf83ade425916d31e547d8077/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-4-1.png" target="_blank">c3b365a</a>
</td>
<td>
John Blischak
</td>
<td>
2017-01-02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now let’s try making a plot that adds in the arrivals of each
type:</p>
<pre class="r"><code>x&lt;-seq(0,t,by=0.01)
n_t&lt;-sapply(x,function(s) sum(arrival_times&lt;s))
plot(x,n_t,type=&#39;l&#39;,xlab=&quot;Time (hours)&quot;,ylab=&quot;# of returning bees&quot;)
for(i in seq(0,K)){
  n_i&lt;-sapply(x,function(s) sum(arrival_times[types==i]&lt;s))
  points(x,n_i,type=&quot;l&quot;,col=(i+2))
}
legend(0,0.8*t*lambda,legend=c(&quot;N(t)&quot;,&quot;# of type 0&quot;,&quot;# of type 1&quot;,&quot;# of type 2&quot;,&quot;# of type 3&quot;,&quot;# of type 4&quot;),lty=1,col=c(1,2,3,4,5,6),cex=0.5)</code></pre>
<p><img src="figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-5-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-5-1">
Past versions of unnamed-chunk-5-1.png
</button>
</p>
<div id="fig-unnamed-chunk-5-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/4e88e63e9fe963f320cb4750de03bbbac34476a7/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-5-1.png" target="_blank">4e88e63</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2026-02-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/5f62ee6cf86b77e9f45e0c6b6e3d6b97c7faf675/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-5-1.png" target="_blank">5f62ee6</a>
</td>
<td>
Matthew Stephens
</td>
<td>
2019-03-31
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/c3b365a48f7fc76cf83ade425916d31e547d8077/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-5-1.png" target="_blank">c3b365a</a>
</td>
<td>
John Blischak
</td>
<td>
2017-01-02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>So cool! We can see the type 4 arrival bees drop off and the type 0
arrivals increase as the hours pass.</p>
<p>What is cooler is that we can generate theoretical expectations for
these patterns. Our simluations should follow some underlying mean
values that we can predict given the parameters. Let’s try.</p>
</div>
<div id="comparison-to-theory" class="section level2">
<h2>Comparison to theory</h2>
<p>For the total number we have a simple Poisson Process, so <span
class="math display">\[
E[N(t)]=\lambda t.
\]</span> Now let’s consider the counts of type <span
class="math inline">\(i\)</span> arrivals. From Poisson Process theory
we know: <span class="math display">\[
E[N_i(t)]=\lambda \int_0^t P_i(s)ds.
\]</span> But what do we obtain from this using our example?</p>
<p>Let’s substitute in our problem-specific <span
class="math inline">\(P_i(s)\)</span>, which we know is binomial
probability mass function with a specific time varying success
probability (<span class="math inline">\(p(t)\)</span>). <span
class="math display">\[
E[N_i(t)]=\lambda \int_0^t \frac{n!}{(n-i)!i!}
(\frac{1}{1+e^{-b(s-a)}})^i(1-\frac{1}{1+e^{-b(s-a)}})^{n-i}ds
\]</span> Nasty! Makes us wish those bees had a simple linear or
exponential decay to their foraging success, because then we’d have some
hope of integrating this mess analytically. As it is, we need to
numerically integrate. To evaluate this for a single <span
class="math inline">\(t\)</span> we could use a single call to the
integrate function, but we’re interested in plotting the mean values
over a range of <span class="math inline">\(t\)</span>, so let’s build
our own (crude) numerical integrator and store the partial integrals for
all the values of t we want.</p>
<pre class="r"><code># Code for numerical intergration 
## Set a little dx for the increments in our numerical integration
dx=0.01
## Initalize a sequence of x&#39;s we will evaluate the integrand
x&lt;-seq(0,9,by=dx)
## Initialize a matrix where we&#39;ll store values of partial integral for each of the K+1 possible types.
int_pt=matrix(nrow=K+1,ncol=length(x))
for(i in seq(0,K)){
    int_pt[i+1,1]&lt;-0
    for(l in seq(2,length(x))){
      ## Being a little cautious, we work with log of integrand evaluated at x
      log_pr&lt;-i*log(1/(1+exp(-b*(x[l]-a))))+(K-i)*log(1-(1/(1+exp(-b*(x[l]-a)))))
      ## And then take exponential, multiply by dx, and to our running sum
      int_pt[i+1,l]&lt;-int_pt[i+1,l-1]+exp(log_pr)*dx
  }
}

# And then we make plots
plot(x,lambda*x,type=&quot;l&quot;,ylab=&quot;E[# of returning bees]&quot;,xlab=&quot;Time (hours)&quot;)
for(i in seq(0,K)){
  points(x,lambda*choose(K,i)*int_pt[i+1,],type=&quot;l&quot;,col=(i+2))
}
legend(0,0.8*t*lambda,legend=c(&quot;N(t)&quot;,&quot;# of type 0&quot;,&quot;# of type 1&quot;,&quot;# of type 2&quot;,&quot;# of type 3&quot;,&quot;# of type 4&quot;),lty=1,col=c(1,2,3,4,5,6),cex=0.5)</code></pre>
<p><img src="figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-6-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-6-1">
Past versions of unnamed-chunk-6-1.png
</button>
</p>
<div id="fig-unnamed-chunk-6-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/4e88e63e9fe963f320cb4750de03bbbac34476a7/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-6-1.png" target="_blank">4e88e63</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2026-02-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/5f62ee6cf86b77e9f45e0c6b6e3d6b97c7faf675/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-6-1.png" target="_blank">5f62ee6</a>
</td>
<td>
Matthew Stephens
</td>
<td>
2019-03-31
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/c3b365a48f7fc76cf83ade425916d31e547d8077/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-6-1.png" target="_blank">c3b365a</a>
</td>
<td>
John Blischak
</td>
<td>
2017-01-02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Victory! Our theory for the expectation matches the observed pattern
fairly nicely.</p>
</div>
<div id="a-follow-up-question-about-the-hive" class="section level2">
<h2>A follow-up question about the hive:</h2>
<p>So what is the total amount of pollen in the hive? We’d guess the
total amount might plateau through time. To calculate the amount, call
it <span class="math inline">\(F(t)\)</span>, we can do some basic
accounting to write it as</p>
<p><span class="math display">\[
F(t)=\sum_{i=1}^K iN_i(t).
\]</span> Let’s just look at this based on the results of our
expectation:</p>
<pre class="r"><code>Ft&lt;-rep(0,length(x))
for(i in seq(0,K)){
  Ft&lt;-Ft+i*int_pt[i+1,]
}
plot(Ft)</code></pre>
<p><img src="figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-7-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-7-1">
Past versions of unnamed-chunk-7-1.png
</button>
</p>
<div id="fig-unnamed-chunk-7-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/4e88e63e9fe963f320cb4750de03bbbac34476a7/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-7-1.png" target="_blank">4e88e63</a>
</td>
<td>
Peter Carbonetto
</td>
<td>
2026-02-05
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/5f62ee6cf86b77e9f45e0c6b6e3d6b97c7faf675/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-7-1.png" target="_blank">5f62ee6</a>
</td>
<td>
Matthew Stephens
</td>
<td>
2019-03-31
</td>
</tr>
<tr>
<td>
<a href="https://github.com/pcarbo/fiveMinuteStats/blob/c3b365a48f7fc76cf83ade425916d31e547d8077/docs/figure/poisson_process_time_dependent_thinning.Rmd/unnamed-chunk-7-1.png" target="_blank">c3b365a</a>
</td>
<td>
John Blischak
</td>
<td>
2017-01-02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>And indeed we see a plateau! When does it suggest the bees should
stop bothering with collecting?</p>
</div>
</div>
<div id="extensions" class="section level1">
<h1>Extensions</h1>
<div id="challenge-problem-1" class="section level2">
<h2>Challenge Problem 1</h2>
<p>Repeat the problem above but assume a linear decay from a probability
of 1 to 0 over the time period of 0 to <span
class="math inline">\(t\)</span>. As the main challenge, derive an
analytical form for the mean of <span
class="math inline">\(N_i(t)\)</span> (i.e, you should not need to use
the numerical solution for the integral obtained above, though you could
use it to check your answer!).</p>
</div>
<div id="challenge-problem-2" class="section level2">
<h2>Challenge Problem 2</h2>
<p>Consider a system where there are only two possible types of arrivals
at time <span class="math inline">\(t\)</span>: <span
class="math inline">\(N_1(t)\)</span> and <span
class="math inline">\(N_2(t)\)</span>. And let’s add a wrinkle of
complexity. An arrival at time <span class="math inline">\(s\)</span>
will first be of type 1, but will transition to be type 2 at a random
time. Let that waiting time be distributed according to a cumulative
distribution function <span class="math inline">\(G(s)\)</span>. This
implies an arrival at time <span class="math inline">\(s\)</span> will
still be type <span class="math inline">\(1\)</span> at time <span
class="math inline">\(t\)</span> with probability <span
class="math inline">\(G(t-s)\)</span> and will have changed to type 2
with probability <span class="math inline">\(1-G(t-s)\)</span>.</p>
<p>This sounds complicated, but we can still apply our time-dependent
Poission Process results to it. In this case <span
class="math inline">\(P_1(t)=\int_0^t
G(t-s)ds\)</span> and <span class="math inline">\(P_2(t)=\int_0^t
(1-G(t-s))ds\)</span>. For the case where <span
class="math inline">\(G(s)=e^{-\lambda_{12}}\)</span>, generate
simulation code and test it against the theory as we did above. One
challenge will be that your code for assigning types will depend on
<span class="math inline">\(s\)</span> and <span
class="math inline">\(t\)</span>!</p>
<p>To provide a biological motivation, ground your work in supposing you
are monitoring a susceptible population of individuals and <span
class="math inline">\(\lambda\)</span> is the rate of arrival of
infected individuals to your hospital over the period of 100 days.
Suppose <span class="math inline">\(\lambda=0.5\)</span> patient
arrivals per day. Suppose the survival time of individuals in your
hospital is exponential with rate of 0.1 patients per day (<span
class="math inline">\(\lambda_{12}=0.2\)</span>).</p>
<p>As a practical application of the model, try to answer these
questions: 1) What is the average number of patients you expect 100 days
into the epidemic? 2) You’d be cursed to design your hospital based on
the average number, because you’d have to turn away sick patients quite
often. So if you are preparing for a particularly bad outcome, say the
upper number of patients that would be expected in 1 out of 100
epidemics, how many beds would you put in your hospital?</p>
</div>
<div id="challenge-problem-3" class="section level2">
<h2>Challenge Problem 3</h2>
<p>A further challenge: Consider each arrival is initially of type 0 and
that the probabiity an item arriving at time <span
class="math inline">\(s\)</span> is of type <span
class="math inline">\(i\)</span> at time <span
class="math inline">\(t\)</span> is determined by a continous time
Markov transition probability matrix <span
class="math inline">\(P_{0i}(t-s)\)</span>. For a simple transition
matrix of your choice, work out a simulation and check against the
theory.</p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()
# R version 4.3.3 (2024-02-29)
# Platform: aarch64-apple-darwin20 (64-bit)
# Running under: macOS 15.7.1
# 
# Matrix products: default
# BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
# LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0
# 
# locale:
# [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
# 
# time zone: America/Chicago
# tzcode source: internal
# 
# attached base packages:
# [1] stats     graphics  grDevices utils     datasets  methods   base     
# 
# loaded via a namespace (and not attached):
#  [1] vctrs_0.6.5       cli_3.6.5         knitr_1.50        rlang_1.1.6      
#  [5] xfun_0.52         stringi_1.8.7     promises_1.3.3    jsonlite_2.0.0   
#  [9] workflowr_1.7.1   glue_1.8.0        rprojroot_2.0.4   git2r_0.33.0     
# [13] htmltools_0.5.8.1 httpuv_1.6.14     sass_0.4.10       rmarkdown_2.29   
# [17] evaluate_1.0.4    jquerylib_0.1.4   tibble_3.3.0      fastmap_1.2.0    
# [21] yaml_2.3.10       lifecycle_1.0.4   whisker_0.4.1     stringr_1.5.1    
# [25] compiler_4.3.3    fs_1.6.6          Rcpp_1.1.0        pkgconfig_2.0.3  
# [29] later_1.4.2       digest_0.6.37     R6_2.6.1          pillar_1.11.0    
# [33] magrittr_2.0.3    bslib_0.9.0       tools_4.3.3       cachem_1.1.0</code></pre>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
